<%# app/views/transactions/index.html.erb %>
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
     <h2>Your Transaction History</h2>
     <%= link_to 'New Transaction', new_wallet_transaction_path(current_user.wallet), class: 'btn btn-primary' %>
   </div>

     <div class="mb-3">
    <%= form_with url: transactions_path, method: :get do |f| %>
      <div class="row">
        <div class="col-md-4">
          <%= f.select :transaction_type,
              options_for_select(
                Transaction.transaction_types.keys.map { |t| [t.titleize, t] },
                selected: params[:transaction_type]
              ),
              { include_blank: 'All Types' },
              class: 'form-select',
              onchange: 'this.form.submit()' %>
        </div>
      </div>
    <% end %>
  </div>

  <table class="table table-striped">
    <thead>
      <tr>
        <th>Date</th>
        <th>Type</th>
        <th>Amount</th>
        <th>Status</th>
        <th>Method</th>
        <th>Details</th>
      </tr>
    </thead>
    <tbody>
      <% @transactions.each do |transaction| %>
        <tr>
          <td><%= transaction.created_at.strftime('%b %d, %Y %H:%M') %></td>
          <td><%= transaction.transaction_type.titleize %></td>
          <td><%= number_to_currency(transaction.amount, unit: 'XAF') %></td>
          <td><span class="badge bg-<%= transaction_status_class(transaction.status) %>">
              <%= transaction.status.titleize %>
            </span>
          </td>
          <td><%= transaction.payment_method.titleize %></td>
          <td><%= link_to 'View', transaction_path(transaction), class: 'btn btn-sm btn-info' %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <%= paginate @transactions %>
</div>
